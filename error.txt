Preprocessing comments and summarizing if necessary...
Time taken to initialize summarization pipeline: 4.490712404251099
C:\Users\m.berenji\Desktop\To Move\git\NPS Script\transcript_categories\batch_summary_transcript_v1broken.py:99: FutureWarning: The behavior of `series[i:j]` with an integer-dtype index is deprecated. In a future version, this will be treated as *label-based* indexing, consistent with e.g. `series[i]` lookups. To retain the old behavior, use `series.iloc[i:j]`. To get the future behavior, use `series.loc[i:j]`.
  summaries = summarization_pipeline(texts[i:i+batch_size], max_length=max_length, min_length=min_length, do_sample=False)
C:\Users\m.berenji\Desktop\To Move\git\NPS Script\transcript_categories\batch_summary_transcript_v1broken.py:105: FutureWarning: The behavior of `series[i:j]` with an integer-dtype index is deprecated. In a future version, this will be treated as *label-based* indexing, consistent with e.g. `series[i]` lookups. To retain the old behavior, use `series.iloc[i:j]`. To get the future behavior, use `series.loc[i:j]`.
  all_summaries.extend(texts[i:i+batch_size])
Time taken to summarize batch: 0.0019998550415039062
Time taken to summarize batch: 0.0
Time taken to summarize batch: 0.0
Preprocessed comments and summarized. Time taken: 4.598120212554932 seconds.
Start comment embeddings in batches
Batch comment embeddings done. Time taken: 5.517219543457031 seconds.
Computing sentiment scores...
Sentiment scores computed. Time taken: 1.1620922088623047 seconds.
Computing semantic similarity and assigning categories...
Computed semantic similarity and assigned categories. Time taken: 0.3181428909301758 seconds.
C:\Python311\Lib\site-packages\xlsxwriter\workbook.py:339: UserWarning: Calling close() on already closed file.
  warn("Calling close() on already closed file.")
